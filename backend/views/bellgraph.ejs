<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="./styles/Bellgraph.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Outfit:wght@100..900&family=Rubik:ital,wght@0,300..900;1,300..900&display=swap"
    rel="stylesheet"
  />
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <title>Bellgraph</title>
</head>
<body class="outfit">
  <%- include("header.ejs") %>
  <%- include("sidebar.ejs") %>

  <!-- Empty container for dynamic content -->
  <div id="bellgraph-container"></div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="/scripts/bellgraph.js"></script>
  <script>
    // Load the partial HTML dynamically
    async function loadGradesPartial() {
      try {
        const res = await fetch("/bellgraph/partial");
        if (!res.ok) throw new Error("Failed to fetch partial");
        const html = await res.text();
        document.getElementById("bellgraph-container").innerHTML = html;

        // Reinitialize after loading
        if (typeof initBellGraph === "function") initBellGraph();
      } catch (err) {
        console.error("Error loading partial:", err);
      }
    }

    // Initial load and periodic refresh
    loadGradesPartial();
    setInterval(loadGradesPartial, 30000);
  </script>
</body>
</html>
