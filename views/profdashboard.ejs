<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="/styles/Profdashboard.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;700&family=Outfit:wght@100..900&display=swap"
    rel="stylesheet" />
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <title>Dashboard</title>
</head>

<body class="outfit">
  <%- include("header.ejs") %>

    <div class="dashboard-wrapper">
      <p class="dashboard-title">Dashboard</p>

      <div class="welcome-text">
        <p>
          <span class="gradient-text">Welcome back,</span><br />
          <span class="prof-light">Dr.</span>
          <span class="prof-bold">
            <%= professor.name %>
          </span>
        </p>
      </div>

      <form class="marks-upload-form" action="/prof/submit" method="post" enctype="multipart/form-data">
        <div class="courses-selection-container">
          <p class="assigned-courses-title">Assigned Courses:</p>
          <div class="assigned-courses-box">
            <% if (courses.length> 0) { %>
              <% courses.forEach(course=> { %>
                <label class="course-box-label">
                  <input type="radio" name="courseId" value="<%= course.id %>" class="hidden-radio">
                  <div class="course-box">
                    <p class="course-code">
                      <%= course.name %>
                    </p>
                    <div class="course-section">
                      <img src="/assets/section-icon.png" alt="Section" class="section-icon" />
                      <span>Sec-<%= course.section %></span>
                    </div>
                    </p>
                  </div>
                </label>
                <% }) %>
                  <% } else { %>
                    <p>No assigned courses available.</p>
                    <% } %>
          </div>
        </div>

        <div class="upload-container">
          <p class="upload-title">Upload page:</p>
          <div class="upload-box-wrapper">
            <div class="file-upload">
              <input type="file" name="marksheet" id="file" class="hidden-file" accept=".csv" />
              <label for="file" class="custom-file-label">
                <div class="upload-content">
                  <div class="upload-icon"></div>
                  <div class="upload-text">
                    <p>Drag & drop files here</p>
                    <span>or</span>
                    <p class="browse-files">Browse files</p>
                  </div>
                </div>
              </label>
              <div class="file-note-wrapper">
                <img src="/assets/warn7.png" alt="Warning" class="warning-icon" />
                <div class="note-text-content">
                  <p class="file-note">Note:</p>
                  <p class="file-note1">Only .csv supported</p>
                </div>
              </div>
            </div>
            <button class="submit-btn" type="submit">
              <span class="submit-text">Submit</span>
            </button>
          </div>
        </div>
      </form>
    </div>

    <script>
      // JavaScript for drag and drop and file name display
      const fileUpload = document.querySelector('.custom-file-label');
      const fileInput = document.getElementById('file');
      const uploadText = document.querySelector('.upload-text');
      const originalUploadText = uploadText.innerHTML;

      fileUpload.addEventListener('dragover', (e) => {
        e.preventDefault();
        fileUpload.classList.add('dragged-over');
      });

      fileUpload.addEventListener('dragleave', () => {
        fileUpload.classList.remove('dragged-over');
      });

      fileUpload.addEventListener('drop', (e) => {
        e.preventDefault();
        fileUpload.classList.remove('dragged-over');
        const files = e.dataTransfer.files;
        if (files.length > 0) {
          fileInput.files = files;
          uploadText.innerHTML = `<p class="file-name">${files[0].name}</p>`;
        }
      });

      fileInput.addEventListener('change', () => {
        if (fileInput.files.length > 0) {
          uploadText.innerHTML = `<p class="file-name">${fileInput.files[0].name}</p>`;
        } else {
          uploadText.innerHTML = originalUploadText;
        }
      });
    </script>
</body>

</html>