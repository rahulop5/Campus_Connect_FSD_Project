<!DOCTYPE html>
<html>
<head>
  <title>Admin Dashboard</title>
  <link rel="stylesheet" href="/styles/Admindashboard.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@100..900&family=Rubik:ital,wght@0,300..900;1,300..900&display=swap" rel="stylesheet">
  <script src="/scripts/admin.js" defer></script>
</head>
<body>
  <header>
    <a href="http://localhost:3000/dashboard" style="text-decoration: none;"><p class="logo">Campus<span>C</span>onnect</p></a>
    <% if (locals.title) { %>
      <div>|</div>
      <a href="http://localhost:3000/login"><p>Log in</p></a>
      <a href="http://localhost:3000/signup" style="text-decoration: none;"><div id="signup"><p>Sign up</p></div></a>
    <% } else { %>
      <!-- optional header content -->
    <% } %>
  </header>

  <main>
    <div id="top_row">
      <div id="dash_welcm_admn_div">
        <div class="green_gradient" id="dashboard_div">
          Dashboard
        </div>
        <div id="welcm_nd_admn_div">
          <div class="green_gradient" id="welcome_div">
            Welcome back,
          </div>
          <div id="admin_div">
            <%= name %>
          </div>
        </div>
      </div>
      <div id="date_holding_container_outer">
        <div id="date_holding_container_inner">
          <div id="content_inside_dateboox_container">
            <div id="day" class="contents_inside_datebox"></div>
            <div id="date" class="contents_inside_datebox"></div>
            <div id="month_year" class="contents_inside_datebox"></div>
          </div>
        </div>
      </div>
    </div>

    <div class="management-section">
      <!-- ========================== COURSE MANAGEMENT ========================== -->
      <div class="course-container">
        <h2>Course Management</h2>
        <!-- Add Course Form -->
        <form id="add-course-form" action="/admin/dashboard" method="POST">
          <input type="hidden" name="action" value="add-course">
          <label for="course-name">Name of the Course:</label>
          <input type="text" id="course-name" name="name" placeholder="e.g., Operating Systems" required>

          <label for="professor">Professor Assigned:</label>
          <select id="professor" name="professor" required>
            <option value="">Select a Professor</option>
            <% professors.forEach(prof => { %>
              <option value="<%= prof._id %>"><%= prof.name %> (<%= prof.email %>)</option>
            <% }) %>
          </select>

          <label for="section">Section:</label>
          <div class="input-group">
            <input type="text" id="section" name="section" placeholder="e.g., 1" required>
          </div>

          <label for="total-classes">Total No. of Classes:</label>
          <div class="input-group">
            <input type="number" id="total-classes" name="totalclasses" placeholder="e.g., 36" min="1" required>
          </div>

          <label for="credits">Course's Credits:</label>
          <div class="input-group">
            <input type="number" id="credits" name="credits" placeholder="e.g., 4" min="1" required>
          </div>

          <button type="submit">Add Course</button>
        </form>

        <!-- Remove Course Form -->
        <h2>Remove Course</h2>
        <form id="remove-course-form" action="/admin/dashboard" method="POST">
          <input type="hidden" name="action" value="remove-entire-course">
          <label for="remove-course-entire-select">Select Course:</label>
          <select id="remove-course-entire-select" name="course" required>
            <option value="">Select a Course</option>
            <% courses.forEach(course => { %>
              <option value="<%= course._id %>"><%= course.name %> (Section <%= course.section %>)</option>
            <% }) %>
          </select>
          <button type="submit">Remove Course</button>
        </form>
        <div id="error-message" class="course-error"><% if (error) { %><%= error %><% } %></div>
      </div>

      <!-- ========================== STUDENT MANAGEMENT ========================== -->
      <div class="student-container">
        <h2 id="student-form-title">Add New Student</h2>
        <button id="toggle-student-mode" class="toggle-btn">Switch to Remove Student</button>
        <form id="student-form" action="/admin/dashboard" method="POST">
          <input type="hidden" name="action" value="add-student">
          <div id="student-form-fields">
            <label for="student-name">Name of the Student:</label>
            <input type="text" id="student-name" name="name" required>

            <label for="student-email">Email of the Student:</label>
            <input type="email" id="student-email" name="email" required>

            <label for="student-rollnumber">Roll Number:</label>
            <input type="text" id="student-rollnumber" name="rollnumber" required>

            <label for="student-phone">Phone Number:</label>
            <input type="tel" id="student-phone" name="phone" required>

            <label for="student-section">Section:</label>
            <input type="text" id="student-section" name="section" required>

            <label for="student-password">Set Password:</label>
            <input type="password" id="student-password" name="password" required>
          </div>
          <button type="submit" id="student-submit-btn">Add Student</button>
        </form>
      </div>

      <!-- ========================== PROFESSOR MANAGEMENT ========================== -->
      <div class="professor-container">
        <h2>Add New Professor</h2>
        <form id="add-professor-form" action="/admin/dashboard" method="POST">
          <input type="hidden" name="action" value="add-professor">
          <label for="prof-name">Name of the Professor:</label>
          <input type="text" id="prof-name" name="name" required>

          <label for="prof-email">Email of the Professor:</label>
          <input type="email" id="prof-email" name="email" required>

          <label for="prof-phone">Phone Number:</label>
          <input type="tel" id="prof-phone" name="phone" required>

          <label for="prof-password">Set Password:</label>
          <input type="password" id="prof-password" name="password" required>

          <button type="submit">Add Professor</button>
        </form>

        <!-- Remove Professor Form -->
        <h2>Remove Professor</h2>
        <form id="remove-professor-form" action="/admin/dashboard" method="POST">
          <input type="hidden" name="action" value="remove-professor">
          <label for="remove-entire-professor-select">Select Professor:</label>
          <select id="remove-entire-professor-select" name="professor" required>
            <option value="">Select a Professor</option>
            <% professors.forEach(prof => { %>
              <option value="<%= prof._id %>"><%= prof.name %> (<%= prof.email %>)</option>
            <% }) %>
          </select>

          <label for="course-action">What to do with assigned courses:</label>
          <select id="course-action" name="course_action" required>
            <option value="">Select an option</option>
            <option value="remove">Remove all courses</option>
            <option value="reassign">Reassign all to another professor</option>
          </select>

          <div id="reassign-professor-selection-prof" style="display: none;">
            <label for="new-professor-select-prof">Select New Professor:</label>
            <select id="new-professor-select-prof" name="new_professor">
              <option value="">Select a Professor</option>
              <% professors.forEach(prof => { %>
                <option value="<%= prof._id %>"><%= prof.name %> (<%= prof.email %>)</option>
              <% }) %>
            </select>
          </div>

          <button type="submit">Remove Professor</button>
        </form>
        <div id="prof-error" class="course-error"><% if (error) { %><%= error %><% } %></div>
      </div>
    </div>

    <h2>Existing Courses</h2>
    <% if (courses.length > 0) { %>
      <ul class="course-list">
        <% courses.forEach(course => { %>
          <li>
            <%= course.name %> (Section <%= course.section %>) - 
            Professor: <%= course.professor.name %> - 
            Credits: <%= course.credits %> - 
            Total Classes: <%= course.totalclasses %>
          </li>
        <% }) %>
      </ul>
    <% } else { %>
      <p class="no-items">No courses available.</p>
    <% } %>

    <h2>Existing Professors</h2>
    <% if (professors.length > 0) { %>
      <ul class="professor-list">
        <% professors.forEach(prof => { %>
          <li>
            <%= prof.name %> - Email: <%= prof.email %> - Phone: <%= prof.phone %>
          </li>
        <% }) %>
      </ul>
    <% } else { %>
      <p class="no-items">No professors available.</p>
    <% } %>

    <h2>Existing Students</h2>
    <% if (students.length > 0) { %>
      <ul class="student-list">
        <% students.forEach(student => { %>
          <li>
            <%= student.name %> - Email: <%= student.email %> - Roll Number: <%= student.rollnumber %> - Phone: <%= student.phone %> - Section: <%= student.section %>
          </li>
        <% }) %>
      </ul>
    <% } else { %>
      <p class="no-items">No students available.</p>
    <% } %>

    <a href="/" class="back-home">Back to Home</a>
  </main>
</body>
</html>